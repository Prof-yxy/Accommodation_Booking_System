# 前端开发环境配置

## 环境变量配置

### .env (开发环境)

```env
# API 基础 URL
VITE_API_BASE_URL=http://localhost:8080/api

# 应用名称
VITE_APP_NAME=Camping Booking System

# 应用版本
VITE_APP_VERSION=1.0.0
```

### .env.production (生产环境)

```env
# API 基础 URL (生产环境后端地址)
VITE_API_BASE_URL=https://api.example.com/api

# 应用名称
VITE_APP_NAME=Camping Booking System

# 应用版本
VITE_APP_VERSION=1.0.0

# 生产环境特性开关
VITE_ENABLE_ANALYTICS=true
VITE_ENABLE_SENTRY=true
```

### .env.staging (测试环境)

```env
# API 基础 URL (测试环境后端地址)
VITE_API_BASE_URL=https://staging-api.example.com/api

# 应用名称
VITE_APP_NAME=Camping Booking System (Staging)

# 应用版本
VITE_APP_VERSION=1.0.0

# 测试环境特性开关
VITE_ENABLE_ANALYTICS=true
VITE_ENABLE_SENTRY=false
VITE_DEBUG_MODE=true
```

## 使用方法

### 在代码中访问环境变量

```typescript
// 正确用法 (Vite)
const apiBaseUrl = import.meta.env.VITE_API_BASE_URL
const appName = import.meta.env.VITE_APP_NAME
const isDev = import.meta.env.DEV
const isProd = import.meta.env.PROD
```

### 运行不同环境

```bash
# 开发环境 (使用 .env 和 .env.development)
npm run dev

# 测试环境
npm run build -- --mode staging

# 生产环境 (使用 .env.production)
npm run build

# 预览生产构建
npm run preview
```

## vite.config.ts 配置参考

```typescript
import { defineConfig, loadEnv } from 'vite'
import vue from '@vitejs/plugin-vue'
import path from 'path'

export default defineConfig(({ command, mode }) => {
  // 加载环境变量
  const env = loadEnv(mode, process.cwd(), '')

  return {
    plugins: [vue()],
    resolve: {
      alias: {
        '@': path.resolve(__dirname, './src')
      }
    },
    server: {
      port: 3000,
      strictPort: false,
      open: true,
      proxy: {
        '/api': {
          target: env.VITE_API_BASE_URL || 'http://localhost:8080',
          changeOrigin: true,
          pathRewrite: {
            '^/api': ''
          }
        }
      }
    },
    build: {
      target: 'esnext',
      minify: 'esbuild',
      cssCodeSplit: true,
      sourcemap: mode !== 'production',
      rollupOptions: {
        output: {
          manualChunks: {
            'vue': ['vue'],
            'element-plus': ['element-plus'],
            'utils': ['axios', 'pinia']
          }
        }
      }
    }
  }
})
```

## 常见配置场景

### 本地开发

确保后端服务运行在 `http://localhost:8080`，使用默认的 `.env` 配置。

### 调用远程 API

在 `.env.development.local` 中覆盖 API 地址：

```env
VITE_API_BASE_URL=https://api.example.com/api
```

### 跨域问题处理

如果后端不在 localhost，在 `vite.config.ts` 中配置代理：

```typescript
proxy: {
  '/api': {
    target: 'http://remote-api.com',
    changeOrigin: true,
    rewrite: (path) => path.replace(/^\/api/, '')
  }
}
```

## 类型安全提示

为了获得更好的类型提示，在 `vite-env.d.ts` 中定义环境变量类型：

```typescript
/// <reference types="vite/client" />

interface ImportMetaEnv {
  readonly VITE_API_BASE_URL: string
  readonly VITE_APP_NAME: string
  readonly VITE_APP_VERSION: string
  readonly VITE_ENABLE_ANALYTICS?: boolean
  readonly VITE_ENABLE_SENTRY?: boolean
  readonly VITE_DEBUG_MODE?: boolean
}

interface ImportMeta {
  readonly env: ImportMetaEnv
}
```
